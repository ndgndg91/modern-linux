# 로깅
- 사람이 사용하기에 최적화된 텍스트 페이로드가 있는 개별 이벤트.
- 로그로 인한 오버헤드는 피하는 편이 좋다(조회를 빠르게 하고 풋프린트를 작게하며 디스크 공간을 너무 많이 차지하지 않게 한다.)
  - [logrotate](https://linux.die.net/man/8/logrotate)를 이용한 로그 순환 사용
  - 데이터 온도(data temperature) 개념 사용하여 오래된 로그 파일을 더 저렴하고 느린 스토리지에서 관리
- 잠재적으로 중요한 정보를 유출할 수 있는지 자신에게 질문해야 한다. 비밀번호, API 키, 단순한 사용 식별자 정보(이메일, 계정 ID)
  - 로그가 일반적으로 영구적인 형태에 저장된다. 누군가 민감한 정보에 접근하여 공격에 사용할 수 있음을 의미.
- 로그는 레벨을 정의한다.
  - all
  - trace 
  - debug
  - info
  - warn
  - error
  - fatal

### 개별 이벤트
- 코드베이스의 맥락에서 개별 이벤트이며 로그 메시지의 범위를 작고 구체적으로 유지하면 메시지를 사용하는 사람이 코드에서 해당 위치를 더 쉽게 찾을 수 있다.
  - 데이터베이스 연결이 성공적으로 설정되었다는 로그행
  - 파일이 없다는 오류 표시
- 텍스트 페이로드
  - 텍스트이며 기본 소비자는 사람이다.

## Syslog
- 커널에서부터, 데몬, 사용자 공간까지 이르는 다양한 소스의 로깅 표준.
- RFC 5424 에 정의된 텍스트 형식
  - PRI: 메시지의 장비 유형과 심각도
  - VER: Syslog 프로토콜 번호(1만 가능)
  - TS: ISO 8601 형식을 사용하여 메시지가 생성된 시각을 표시
  - HN: 메시지를 보낸 시스템을 식별
  - APP: 메시지를 보낸 애플리케이션(또는 디바이스) 식별
  - PID: 메시지를 보낸 프로세스 식별
  - MID(옵션): 메시지 ID
- 각 요소가 [] 로 묶인 키/값 기반 구조화된 데이터를 포함.
- 로그 관리에는 syslogd 바이너리를 사용
  - syslog-ng
    - syslogd 의 드롭인 교체로 사용 가능. TLS, 콘텐츠 기반 필터링, PostgreSQL 과 MongoDB 같은 데이터베이스 로그인을 추가로 지원하는 향상된 로그 데몬. 1990년 말부터 가능
  - rsyslog
    - Syslog 프로토콜을 확장. systemd 와 함께 사용. 2004 년 부터 가능
- systemd 가 모든 주요 리눅스 배포한에서 사용되는 init 시스템의 사실상 표준이 되면서 로깅에 대한 새로운 방법으로 `systemd 저널`이 등장.

## journalctl
- systemd 에코시스템의 일부이며 로그 관리를 담당하는 구성 요소.
- 바이너리 형식을 사용하여 로그 항목을 저장하여 빠르게 접근하고 저장 공간도 더 많이 확보한다.
- 바이너리 형식이라서 tail, cat, grep 명령어를 그대로 사용할 수 없다.
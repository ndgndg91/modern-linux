# 커널 구성요소
- 모놀리식 커널이지만, 코드베이스에는 특정 역할을 식별하고 부여할 수 있는 기능 영역이 나뉘어 있다.
- 커널은 하드웨어와 실행하려는 앱 사이에 있다.

1. 프로세스 관리: 실행 파일을 기반으로 프로세스를 시작
2. 메모리 관리: 프로세스에 메모리를 할당하거나 파일을 메모리에 매핑함
3. 네트워킹: 네트워크 인터페이스 관리나 네트워크 스택 제공
4. 파일시스템: 파일 관리를 제공하고, 파일 생성과 삭제를 지원
5. 캐릭터 디바이스와 디바이스 드라이버 관리


## 프로세스 관리
- 인터럽트 같은 CPU 아키텍처 관련 사항을 처리, 프로그램 실행과 스케줄링에 중점을 둔다.
- 프로세스는 실행 가능한 프로그램을 기반으로 하며, 사용자가 대면하는 Unit 이다.
- 스레드는 프로세스 컨텍스트상에서의 실행 유닛 이다.
- 멀티스레드는 프로세스에서 여러 실행 유닛이 병렬로 실행되며 잠재적으로 각기 다른 CPU 에서 실행될 수 있다.

### 세션
하나 이상의 프로세스 그룹을 포함, 선택적으로 tty가 연결된 상위 수준의 사용자 대면 유닛. 커널은 `SID` 로 식별.
### 프로세스 그룹
하나 이상의 프로세스가 포함, 한 세션에는 포어그라운드 프로세스 그룹이 하나만 존재. 커널은 `PGID` 로 식별
### 프로세스
여러 리소스(주소 공간, 스레드, 소켓 등)를 그룹으로 추상화한 것, `PID` 로 식별
### 스레드
커널은 `TID` 와 `TGID`(멀티스레드) 로 식별
### 태스크
sched.h 에 의해 정의된 task_struct 라는 데이터 구조가 존재, 프로세스와 스레드 구현의 기반을 형성하며 스케줄링 관련 정보, 식별자, 시그널 처리기, 성능이나 보안과 관련된 정보를 수집.
모든 유닛은 태스크에서 파상되며 고정(anchor)된다.

```
% ps -j
USER   PID  PPID  PGID   SESS JOBC STAT   TT       TIME COMMAND
giri  2093  2092  2093      0    1 S+   s000    0:00.07 -zsh
giri  2604  2603  2604      0    1 S    s001    0:00.03 -zsh
```

## 메모리 관리
- 가상 메모리는 시스템이 물리적으로 갖고 있는 것보다 더 많은 메모리를 갖고 있는 것처럼 보이게 함
- 페이지라고 부르는 고정 길이의 청크로 관리
- 가상 페이지는 주 메모리(RAM) 의 물리적 페이지에 매핑
- 실제로 여러 가상 페이지가 동일한 물리적 페이지를 가리킬 수 있음
- CPU 는 프로세스의 가상 페이지에 접근할 때마다 원칙적으로 물리적 페이지 주소로 변환해야함. 최신 CPU 아키텍처는 TLB(translation lookaside buffer) 라는 조회용 온칩을 지원하며 매우 작은 cache 역할을 함.
- 전통적으로 리눅스의 기본 페이지 크기는 4KB

## 네트워킹
아래 작업들은 커널이 처리하는 모든 것이다. `HTTP`나 `SSH` 같은 애플리케이션 계층 프로토콜은 사용자 영역에서 구현된다.
- 소켓 `Socket` - 추상화 커뮤니케이션 위해 필요
- 전송 제어 프로토콜 `Transmission Control Protocol(TCP)` - 연결형 통신
- 사용자 데이터그램 프로토콜 `User Datagram Protocol(UDP)` - 비연결형 통신
- 인터넷 프로토콜 `(IP)` - 기기의 주소 지정을 위해 필요

## 파일시스템
- 하드 디스크 드라이브(HDD), 솔리드 스테이트 드라이브(SSD), 플래시 메모리 같은 저장 디바이스의 파일과 디렉터리를 구성한다.
- ext4, btrfs, NTFS 같은 다양한 유형의 파일시스템이 존재

## 디바이스 드라이버
- 드라이버는 커널에서 실행되는 코드다.
- 키보드, 마우스, 하드 디스크 드라이브 같은 실제 하드웨어 디바이스나 의사 디바이스 관리함.
- 그래픽 처리 장치(GPU)
- 드라이버는 커널에 정적으로 빌드될 수도 있고, 필요할 때 동적으로 로드될 수 있도록 커널 모듈로 빌드될 수 있음.
